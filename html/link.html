<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
<title>NORART klassifikator</title>
<meta charset="UTF-16">
<link rel="stylesheet" href="styles/layout.css" type="text/css">
</head>
<body>
<div class="wrapper row1">
  <header id="header" class="clear">
    <div id="hgroup">
      <h1><a href="index.html">NORART Klassifikator</a></h1>
      <h2>Verktøy for å klassifisere NORART-artikler.</h2>
    <nav>
      <ul>
        <li><a href="text.html">Klassifisering av fulltekst</a></li>
        <li><a href="link.html">Klassifisering av URL eller LINK</a></li>
        <li><a href="documentation.html">Dokumentasjon</a></li>
      </ul>
    </nav>
    </div>
  </header>
</div>

<div class="wrapper row2">
  <div id="container" class="clear">
    <section id="slider" class="clear">
      <input type ="text" id ="URL_from_user"  placeholder="URLen for artikkelen"  </input><br>

      <button onclick="UserAction()">Hent ned artikkel</button>

      <script>
        function generateList(url,result,id_name)
          {

              var listContainer = document.getElementById(id_name);
              var header = document.createElement("h2")
              var paragraph= document.createTextNode("Her er resultatet fra: "+url);
              header.appendChild(paragraph)
              listContainer.appendChild(header);
              var newList = document.createElement("ul");


              for(var i = 0 ; i < result.length ; i ++)
                  {

                      var newListItem = document.createElement("li");
                      var probability=parseFloat(result[i][1])*100;
                      newListItem.innerHTML = "Label: <b>"+result[i][0] + "</b>  Sannsynlighet: <b>"+probability+"%</b>";

                      newList.appendChild(newListItem);

                  }

              listContainer.appendChild(newList);

          }

        function UserAction() {

            var url = document.getElementById("URL_from_user").value;
            var url_encoded = encodeURI(url);
            var server_url = "http://127.0.0.1:5000/rest_doc/"
            full_path_to_response = server_url.concat(url_encoded)
            var xhttp = new XMLHttpRequest();
            result=xhttp.open("GET", full_path_to_response, false);
            xhttp.setRequestHeader("Content-type", "application/json");
            //xhttp.send();
            xhttp.send();
            result=xhttp.responseText;
            result=JSON.parse(result);
            console.log(typeof result);
            //window.open(full_path_to_response.toString());
            //document.getElementById("results").innerHTML=result
            generateList(url,result,"results");
        }
      </script>
    </section>
    
      <article class="two_third">
        <p>Det er ikke garantert at man vi klarer å laste ned artikkelen automatisk, men du vil få se en forhåndsvisning før klassifisering. Om den ikke fikk lastet den ned, så må du lime den inn manuelt. Det kan gjøres <a href="text.html">her</a></p>
      </article>
      <article class="two_third" id="results">
      </article>
  </div>
</div>

<div class="wrapper row3">  
</div>
</body>
</html>
